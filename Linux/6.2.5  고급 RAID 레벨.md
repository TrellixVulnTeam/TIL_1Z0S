## 6.2.5  고급 RAID 레벨

>### RAID6 와 RAID1+0 개념
>
>1. RAID6
>   - 패리티를 2개 사용하므로 최소 4개의 하드디스크가 필요하다
>2. RAID1+0
>   - RAID1(안정성)+RAID0(속도) 이다
>   - 공간효율이 50%이다





#### RAID6 과 RAID1+0을 구성해보자

1. 실습해 필요한 8개의 하드디스크를 추가한다

2. 파티션과정을 해준다

3. mdadm의 명령어를 통해 RAID6 를 형성해준다

   ```bash
   // RAID6 형성
   # mdadm --create /dev/md6 --level=6 --raid-devices=4 /dev/sdb1 /dev/sdc1 /dev/sdd1 /dev/sde1
   
   // 파티션 포맷
   # mkfs.ext4 /dev/md6
   # mkdir /raid6
   # mount /dev/md6 /raid6
   
   // testFile을 복사해서 raid6에 해준다
   # cp /boot/vmlinuz-3* /raid6/testFile
   ```

   ```bash
   ![결함확인](C:\Users\student\Desktop\리눅스\결함확인.PNG)// RAID 1+0 형성
   # mdadm --create /dev/md2 --level=1 --raid-devices=2 /dev/sdf1 /dev/sdg1 
   # mdadm --create /dev/md3 --level=1 --raid-devices=2 /dev/sdh1 /dev/sdi1 
   # mdadm --create /dev/md10 --level=0 --raid-devices=2 /dev/md2 /dev/md3 
   
   // 파티션 포맷
   # mkfs.ext4 /dev/md10
   # mkdir /raid10
   # mount /dev/md10 /raid10
   
   // testFile을 복사해서 raid6에 해준다
   # cp /boot/vmlinuz-3* /raid10/testFile
   ```

   

4. vi /etc/fstab에서 컴퓨터가 재부팅 되더라도 계속 mount를 유지시켜준다

5. halt -p를 통해 시스템을 끈다

6. disk 2,3,5,8을 지워준다

7. server5를 다시 가동시켜본다

8. 장치를 가동해보자(결함확인2)

   ![결함확인](https://user-images.githubusercontent.com/52269210/71710323-0af70680-2e3f-11ea-88a8-2aaa3565c968.PNG)

9. 데이터를 확인해보자(결함확인3)

   ![데이터는안전_부수기](https://user-images.githubusercontent.com/52269210/71710322-0a5e7000-2e3f-11ea-9674-d85f6915613e.PNG)



**데이터는 안전하다**



10. halt -p를 통해 시스템을 종료한다

#### 복구과정

1. 새로운 디스크 4개를 add 한다

2. 결함 허용을 제공하지 않는 RAID장치이기 때문에 ADD만 해주면 된다

   ```bash
    # madam /dev/md6 --add /dev/sdc1
    # madam /dev/md2 --add /dev/sdg1
    # madam /dev/md3 --add /dev/sdh1
    
   ```

   

cf> 만약에 결함허용을 제공하지 않는 RAID인 경우(Linear, RAID0)

```bash
 # madam --stop /dev/md9 
 # mdadm --create /dev/md9 --level=linear --raid-devices=2 /dev/sdb1 /dev/sdc1
 # mdadm --create /dev/md9 --level=0 --raid-devices=2 /dev/sdd1 /dev/sdf1
```

